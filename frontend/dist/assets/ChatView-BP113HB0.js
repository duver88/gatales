import{o,c as n,a as e,p as A,F as N,t as p,b as X,d as v,i as U,q as _,w as D,e as G,v as F,r as h,s as Y,x as oe,h as c,y as Z,z as re,f as T,g as P,T as q,u as _e,A as Me,l as $e,B as J,C as W,D as se,k as Se,E as je,n as ae}from"./index-DnaU9Zpc.js";import{u as ie,a as Be}from"./chat-DGz-QzfI.js";import{u as Le}from"./theme-DnfsB8_1.js";import{_ as ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ze={class:"flex items-start gap-2.5 sm:gap-4 max-w-3xl mx-auto"},Ae=["src"],Te={key:1,class:"text-gatales-text text-xs sm:text-sm font-medium"},Ee={key:1,class:"w-5 h-5 sm:w-6 sm:h-6 text-white",viewBox:"0 0 100 100",fill:"currentColor"},Re={class:"flex-1 min-w-0 overflow-hidden"},He={class:"text-[10px] sm:text-xs text-gatales-text-secondary mb-1 sm:mb-1.5 font-medium"},Ie={class:"text-sm sm:text-base text-gatales-text markdown-content leading-relaxed"},Ve={key:0,class:"thinking-indicator"},Ue={key:1,class:"message-text"},Ne=["innerHTML"],Pe={key:0,class:"streaming-cursor"},qe={key:1,class:"mt-3"},Ge={key:0,class:"text-red-400 text-sm mb-2 flex items-center gap-2"},De={key:1,class:"text-yellow-400 text-sm mb-2 flex items-center gap-2"},Fe={key:0,class:"mt-3 flex justify-start gap-2"},Ze={key:1,class:"mt-3 flex justify-start"},Ke={__name:"ChatMessage",props:{message:{type:Object,required:!0},userAvatar:{type:String,default:null},userName:{type:String,default:"U"},isLastMessage:{type:Boolean,default:!1},isGenerating:{type:Boolean,default:!1}},emits:["retry","regenerate","resend"],setup(B,{emit:w}){const i=B,a=w,d=_(()=>i.message.role==="user"),g=_(()=>i.message.isStreaming===!0),x=_(()=>i.message.isThinking===!0),m=_(()=>i.message.isFailed===!0),k=_(()=>i.message.isStopped===!0),$=_(()=>!d.value&&(m.value||k.value)),M=_(()=>!d.value&&i.isLastMessage&&!g.value&&!x.value&&!m.value&&!k.value&&!i.isGenerating),f=_(()=>d.value&&i.isLastMessage&&!i.isGenerating);function b(){a("retry")}function L(){a("regenerate")}function E(){a("resend")}const S=new Map;function R(y){if(!y)return"";const r=y+(g.value?"_streaming":"");if(!g.value&&S.has(r))return S.get(r);let s=y;s=s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");let j=0;if(s=s.replace(/```(\w*)\n([\s\S]*?)```/g,(V,C,z)=>{const K=j++,ee=C||"code",O=z.trim();return`<div class="code-block-wrapper" data-code-index="${K}">
      <div class="code-block-header">
        <span class="code-lang">${ee}</span>
        <button class="copy-btn" onclick="window.copyCodeBlock(${K}, this)" data-code="${encodeURIComponent(O)}">
          <svg class="copy-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" width="14" height="14">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
          </svg>
          <span class="copy-text">Copiar</span>
        </button>
      </div>
      <pre class="code-block"><code>${O}</code></pre>
    </div>`}),s=s.replace(/`([^`\n]+)`/g,'<code class="inline-code">$1</code>'),s=s.replace(/^### (.+)$/gm,'<h4 class="md-h4">$1</h4>'),s=s.replace(/^## (.+)$/gm,'<h3 class="md-h3">$1</h3>'),s=s.replace(/^# (.+)$/gm,'<h2 class="md-h2">$1</h2>'),s=s.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>"),s=s.replace(new RegExp("(?<!\\*)\\*([^*]+)\\*(?!\\*)","g"),"<em>$1</em>"),s=s.replace(/~~([^~]+)~~/g,"<del>$1</del>"),s=s.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="md-link">$1</a>'),s=s.replace(/^(-{3,}|\*{3,})$/gm,'<hr class="md-hr">'),s=s.replace(/^&gt; (.+)$/gm,'<blockquote class="md-blockquote">$1</blockquote>'),s=s.replace(/^[\-\*] (.+)$/gm,'<li class="md-li">$1</li>'),s=s.replace(/(<li class="md-li">[\s\S]*?<\/li>)(\n<li class="md-li">)/g,"$1$2"),s=s.replace(/(<li class="md-li">[^<]*<\/li>(\n|$))+/g,'<ul class="md-ul">$&</ul>'),s=s.replace(/^\d+\. (.+)$/gm,'<li class="md-oli">$1</li>'),s=s.replace(/(<li class="md-oli">[^<]*<\/li>(\n|$))+/g,'<ol class="md-ol">$&</ol>'),s=s.replace(/\n/g,"<br>"),s=s.replace(/<br>(<\/?(?:ul|ol|li|h[234]|blockquote|hr|div|pre))/g,"$1"),s=s.replace(/(<\/(?:ul|ol|li|h[234]|blockquote|hr|div|pre)>)<br>/g,"$1"),!g.value&&y.length<1e4&&(S.set(r,s),S.size>50)){const V=S.keys().next().value;S.delete(V)}return s}const H=_(()=>R(i.message.content));return typeof window<"u"&&(window.copyCodeBlock=(y,r)=>{const s=decodeURIComponent(r.dataset.code);navigator.clipboard.writeText(s).then(()=>{const j=r.querySelector(".copy-text");j&&(j.textContent="Copiado!",setTimeout(()=>{j.textContent="Copiar"},2e3))})}),(y,r)=>(o(),n("div",{class:A(["px-3 sm:px-4 py-4 sm:py-6 transition-colors",d.value?"message-user":"message-assistant"])},[e("div",ze,[e("div",{class:A(["w-7 h-7 sm:w-8 sm:h-8 rounded-full flex items-center justify-center shrink-0 overflow-hidden ring-2 ring-offset-2 ring-offset-transparent",d.value?"bg-gatales-input ring-gatales-border":"bg-gatales-accent ring-gatales-accent/30"])},[d.value?(o(),n(N,{key:0},[B.userAvatar?(o(),n("img",{key:0,src:B.userAvatar,class:"w-full h-full object-cover",alt:"Avatar"},null,8,Ae)):(o(),n("span",Te,p(B.userName.charAt(0).toUpperCase()),1))],64)):(o(),n("svg",Ee,[...r[0]||(r[0]=[e("path",{d:"M50 15 L25 35 L25 60 Q25 80 50 85 Q75 80 75 60 L75 35 Z"},null,-1),e("path",{d:"M25 35 L15 10 L35 30 Z"},null,-1),e("path",{d:"M75 35 L85 10 L65 30 Z"},null,-1)])]))],2),e("div",Re,[e("p",He,p(d.value?"Tu":"El Cursales"),1),e("div",Ie,[x.value?(o(),n("div",Ve,[...r[1]||(r[1]=[X('<span class="thinking-icon" data-v-4f2d474f>游꼽</span><span class="thinking-text" data-v-4f2d474f>Cocinando respuesta</span><span class="thinking-dots" data-v-4f2d474f><span class="dot" data-v-4f2d474f>.</span><span class="dot" data-v-4f2d474f>.</span><span class="dot" data-v-4f2d474f>.</span></span>',3)])])):(o(),n("div",Ue,[e("div",{innerHTML:H.value},null,8,Ne),g.value?(o(),n("span",Pe,"|")):v("",!0),m.value||k.value?(o(),n("div",qe,[m.value&&B.message.errorMessage?(o(),n("div",Ge,[r[2]||(r[2]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",null,p(B.message.errorMessage),1)])):k.value?(o(),n("div",De,[...r[3]||(r[3]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 10h6v4H9z"})],-1),e("span",null,"Respuesta interrumpida",-1)])])):v("",!0)])):v("",!0)]))]),$.value||M.value?(o(),n("div",Fe,[$.value?(o(),n("button",{key:0,onClick:b,class:"inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-red-400 bg-red-500/10 hover:bg-red-500/20 border border-red-500/30 rounded-lg transition-colors"},[...r[4]||(r[4]=[e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),U(" Reintentar ",-1)])])):v("",!0),M.value?(o(),n("button",{key:1,onClick:L,class:"inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gatales-text-secondary hover:text-gatales-text bg-gatales-input hover:bg-gatales-border border border-gatales-border rounded-lg transition-colors"},[...r[5]||(r[5]=[e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),U(" Regenerar respuesta ",-1)])])):v("",!0)])):v("",!0),f.value?(o(),n("div",Ze,[e("button",{onClick:E,class:"inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-amber-400 bg-amber-500/10 hover:bg-amber-500/20 border border-amber-500/30 rounded-lg transition-colors"},[...r[6]||(r[6]=[e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})],-1),U(" Reenviar mensaje ",-1)])])])):v("",!0)])])],2))}},Oe=ne(Ke,[["__scopeId","data-v-4f2d474f"]]),Qe={class:"border-t border-gatales-border bg-gatales-bg p-2 sm:p-4 safe-area-bottom"},Je={class:"max-w-3xl mx-auto"},We=["disabled"],Xe=["disabled"],Ye={__name:"ChatInput",props:{disabled:{type:Boolean,default:!1},isStreaming:{type:Boolean,default:!1}},emits:["send","stop"],setup(B,{emit:w}){const i=B,a=w,d=h(""),g=h(null),x=_(()=>d.value.trim().length>0&&!i.disabled);function m(){x.value&&(a("send",d.value),d.value="",g.value&&(g.value.style.height="auto"))}function k(M){M.key==="Enter"&&!M.shiftKey&&(M.preventDefault(),m())}function $(){g.value&&(g.value.style.height="auto",g.value.style.height=Math.min(g.value.scrollHeight,200)+"px")}return(M,f)=>(o(),n("div",Qe,[e("div",Je,[e("form",{onSubmit:D(m,["prevent"]),class:"relative"},[G(e("textarea",{ref_key:"textarea",ref:g,"onUpdate:modelValue":f[0]||(f[0]=b=>d.value=b),onKeydown:k,onInput:$,disabled:B.disabled,placeholder:"Escribe tu mensaje...",rows:"1",class:"w-full bg-gatales-input text-gatales-text text-base rounded-xl py-2.5 sm:py-3 pl-3 sm:pl-4 pr-11 sm:pr-12 border border-gatales-border focus:border-gatales-accent focus:outline-none focus:ring-1 focus:ring-gatales-accent placeholder-gatales-text-secondary resize-none disabled:opacity-50 disabled:cursor-not-allowed"},null,40,We),[[F,d.value]]),B.isStreaming?(o(),n("button",{key:0,type:"button",onClick:f[1]||(f[1]=b=>a("stop")),class:"absolute right-1.5 sm:right-2 bottom-1.5 sm:bottom-2 p-2 rounded-lg bg-red-500 text-white hover:bg-red-600 active:scale-95 transition-all touch-manipulation",title:"Detener respuesta"},[...f[2]||(f[2]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 6h12v12H6z"})],-1)])])):(o(),n("button",{key:1,type:"submit",disabled:!x.value,class:"absolute right-1.5 sm:right-2 bottom-1.5 sm:bottom-2 p-2 rounded-lg bg-gatales-accent text-white hover:bg-gatales-accent-hover active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed transition-all touch-manipulation"},[...f[3]||(f[3]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})],-1)])],8,Xe))],32),f[4]||(f[4]=e("p",{class:"hidden sm:block text-xs text-gatales-text-secondary text-center mt-2"}," Presiona Enter para enviar, Shift+Enter para nueva linea ",-1))])]))}},et={class:"flex sm:hidden items-center gap-2"},tt={class:"relative w-10 h-10"},st={class:"w-10 h-10 -rotate-90",viewBox:"0 0 36 36"},at=["stroke-dasharray"],ot={class:"absolute inset-0 flex items-center justify-center text-[11px] font-semibold text-gatales-text"},nt={class:"hidden sm:flex items-center gap-3 px-3 py-2 bg-gatales-sidebar/80 backdrop-blur-sm rounded-xl border border-gatales-border/50"},lt={class:"flex flex-col min-w-0"},rt={class:"flex items-center gap-2"},it={class:"w-16 flex flex-col gap-1"},dt={class:"h-1.5 bg-gatales-input rounded-full overflow-hidden"},ct={__name:"TokenIndicator",props:{balance:{type:Number,required:!0},monthly:{type:Number,required:!0}},setup(B){const w=B,i=_(()=>w.monthly===0?0:Math.min(Math.round(w.balance/w.monthly*100),100)),a=_(()=>i.value>60?"healthy":i.value>25?"warning":"critical"),d=_(()=>({healthy:{gradient:"from-emerald-500 to-green-400",bg:"bg-emerald-500/10",text:"text-emerald-400",ring:"stroke-emerald-400",label:"Disponible",icon:"check"},warning:{gradient:"from-amber-500 to-yellow-400",bg:"bg-amber-500/10",text:"text-amber-400",ring:"stroke-amber-400",label:"Bajo",icon:"alert"},critical:{gradient:"from-red-500 to-rose-400",bg:"bg-red-500/10",text:"text-red-400",ring:"stroke-red-400",label:"Critico",icon:"warning"}})[a.value]);return(g,x)=>(o(),n(N,null,[e("div",et,[e("div",tt,[(o(),n("svg",st,[x[0]||(x[0]=e("circle",{cx:"18",cy:"18",r:"15",fill:"none",stroke:"currentColor","stroke-width":"2.5",class:"text-gatales-border/50"},null,-1)),e("circle",{cx:"18",cy:"18",r:"15",fill:"none",class:A([d.value.ring,"transition-all duration-500 ease-out"]),"stroke-width":"2.5","stroke-linecap":"round","stroke-dasharray":`${i.value*94.25/100} 94.25`},null,10,at)])),e("span",ot,p(i.value)+"% ",1)])]),e("div",nt,[e("div",{class:A(["w-8 h-8 rounded-lg flex items-center justify-center",d.value.bg])},[(o(),n("svg",{class:A(["w-4 h-4",d.value.text]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...x[1]||(x[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"},null,-1)])],2))],2),e("div",lt,[e("div",rt,[e("span",{class:A(["text-base font-bold tabular-nums",d.value.text])},p(i.value)+"% ",3),e("span",{class:A(["text-[10px] font-medium px-1.5 py-0.5 rounded-full",d.value.bg,d.value.text])},p(d.value.label),3)])]),e("div",it,[e("div",dt,[e("div",{class:A(["h-full rounded-full bg-gradient-to-r transition-all duration-500 ease-out",d.value.gradient]),style:Y({width:i.value+"%"})},null,6)])])])],64))}},ut={class:"w-64 bg-gatales-sidebar border-r border-gatales-border flex flex-col h-full"},vt={class:"p-2"},gt=["disabled"],pt={class:"px-2 pb-2"},mt={class:"relative"},xt={key:0,class:"flex justify-center py-6"},ft={key:1,class:"p-3 text-center"},ht={key:2,class:"py-1"},bt={key:0,class:"mb-3"},yt={class:"px-3 py-1 text-[10px] font-medium text-gatales-text-secondary uppercase tracking-wider"},wt={class:"space-y-0.5 px-1"},kt=["onClick","onContextmenu"],Ct={class:"flex-1 min-w-0"},_t=["onClick"],Mt=["onClick"],$t=["onClick"],St=["onClick"],jt={key:0,class:"p-3 text-center"},Bt={__name:"ConversationSidebar",emits:["select","close"],setup(B,{emit:w}){const i=w,a=ie(),d=h(""),g=h(null),x=h(null),m=h("");let k=null;oe(d,r=>{clearTimeout(k),r.length>=2?k=setTimeout(()=>{a.searchConversations(r)},300):a.clearSearch()});const $=_(()=>d.value.length>=2&&a.searchResults.length>0?{search:{title:"Resultados",conversations:a.searchResults}}:a.groupedConversations);async function M(){try{const r=await a.createConversation();i("select",r.id),i("close")}catch(r){console.error("Error creating conversation:",r)}}function f(r){a.selectConversation(r),i("select",r),i("close")}function b(r,s){r.preventDefault(),r.stopPropagation(),g.value=s}function L(){g.value=null}function E(r){x.value=r.id,m.value=r.title||"Nueva conversacion",L()}async function S(){if(x.value&&m.value.trim())try{await a.updateConversationTitle(x.value,m.value.trim())}catch(r){console.error("Error updating title:",r)}x.value=null,m.value=""}function R(){x.value=null,m.value=""}async function H(r){L();try{await a.archiveConversation(r)}catch(s){console.error("Error archiving conversation:",s)}}async function y(r){if(L(),confirm("쮼liminar esta conversacion?"))try{await a.deleteConversation(r)}catch(s){console.error("Error deleting conversation:",s)}}return(r,s)=>(o(),n("aside",ut,[e("div",vt,[e("button",{onClick:M,disabled:c(a).isCreating,class:"w-full flex items-center gap-3 px-3 py-2 text-gatales-text hover:bg-gatales-input rounded-lg transition-colors disabled:opacity-50 text-sm"},[...s[4]||(s[4]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),U(" Nueva conversacion ",-1)])],8,gt)]),e("div",pt,[e("div",mt,[s[5]||(s[5]=e("svg",{class:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gatales-text-secondary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),G(e("input",{"onUpdate:modelValue":s[0]||(s[0]=j=>d.value=j),type:"text",placeholder:"Buscar...",class:"w-full pl-8 pr-3 py-1.5 bg-gatales-input border border-gatales-border rounded-md text-xs text-gatales-text placeholder-gatales-text-secondary focus:outline-none focus:ring-1 focus:ring-gatales-accent focus:border-transparent"},null,512),[[F,d.value]])])]),e("div",{class:"flex-1 overflow-y-auto",onClick:L},[c(a).isLoading?(o(),n("div",xt,[...s[6]||(s[6]=[e("svg",{class:"animate-spin h-5 w-5 text-gatales-accent",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):!c(a).hasConversations&&!d.value?(o(),n("div",ft,[...s[7]||(s[7]=[e("p",{class:"text-gatales-text-secondary text-xs"},"No hay conversaciones",-1)])])):(o(),n("div",ht,[(o(!0),n(N,null,Z($.value,(j,V)=>(o(),n(N,{key:V},[j.conversations?.length>0?(o(),n("div",bt,[e("div",yt,p(j.title),1),e("div",wt,[(o(!0),n(N,null,Z(j.conversations,C=>(o(),n("div",{key:C.id,onClick:z=>f(C.id),onContextmenu:z=>b(z,C.id),class:A(["group relative flex items-center gap-2 px-2 py-1.5 rounded-md cursor-pointer transition-colors",c(a).currentConversationId===C.id?"bg-gatales-accent/10 text-gatales-accent":"hover:bg-gatales-input text-gatales-text"])},[s[9]||(s[9]=e("svg",{class:"w-3.5 h-3.5 shrink-0 opacity-60",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})],-1)),e("div",Ct,[x.value===C.id?G((o(),n("input",{key:0,"onUpdate:modelValue":s[1]||(s[1]=z=>m.value=z),onBlur:S,onKeyup:[re(S,["enter"]),re(R,["escape"])],onClick:s[2]||(s[2]=D(()=>{},["stop"])),class:"w-full bg-gatales-input border border-gatales-border rounded px-1.5 py-0.5 text-xs focus:outline-none focus:ring-1 focus:ring-gatales-accent",autofocus:""},null,544)),[[F,m.value]]):(o(),n("p",{key:1,class:A(["text-xs truncate",C.message_count===0?"italic opacity-60":""])},p(C.title||"Nueva conversacion"),3))]),e("button",{onClick:D(z=>b(z,C.id),["stop"]),class:"hidden group-hover:flex p-0.5 rounded hover:bg-gatales-border transition-colors"},[...s[8]||(s[8]=[e("svg",{class:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"})],-1)])],8,_t),T(q,{name:"fade"},{default:P(()=>[g.value===C.id?(o(),n("div",{key:0,class:"absolute right-0 top-full mt-0.5 z-50 w-32 bg-gatales-sidebar border border-gatales-border rounded-md shadow-lg py-0.5",onClick:s[3]||(s[3]=D(()=>{},["stop"]))},[e("button",{onClick:z=>E(C),class:"w-full text-left px-2.5 py-1.5 text-xs text-gatales-text hover:bg-gatales-input"}," Renombrar ",8,Mt),e("button",{onClick:z=>H(C.id),class:"w-full text-left px-2.5 py-1.5 text-xs text-gatales-text hover:bg-gatales-input"}," Archivar ",8,$t),e("button",{onClick:z=>y(C.id),class:"w-full text-left px-2.5 py-1.5 text-xs text-red-400 hover:bg-gatales-input"}," Eliminar ",8,St)])):v("",!0)]),_:2},1024)],42,kt))),128))])])):v("",!0)],64))),128)),d.value.length>=2&&c(a).searchResults.length===0&&!c(a).isSearching?(o(),n("div",jt,[...s[10]||(s[10]=[e("p",{class:"text-gatales-text-secondary text-xs"},"Sin resultados",-1)])])):v("",!0)]))])]))}},Lt=ne(Bt,[["__scopeId","data-v-e43122df"]]),zt={class:"flex h-screen bg-gatales-bg"},At={class:"flex-1 flex flex-col min-w-0"},Tt={class:"flex items-center justify-between px-2 sm:px-4 py-2 sm:py-3 bg-gatales-sidebar border-b border-gatales-border safe-area-top"},Et={class:"flex items-center gap-2"},Rt={class:"flex items-center gap-2"},Ht={class:"text-sm text-gatales-text-secondary truncate max-w-[150px] sm:max-w-[200px]"},It={class:"text-gatales-text-secondary max-w-[60px] sm:max-w-[100px] truncate"},Vt={class:"flex items-center gap-2 sm:gap-4"},Ut={class:"relative"},Nt={class:"w-8 h-8 rounded-full bg-gatales-accent flex items-center justify-center text-white font-medium text-sm overflow-hidden"},Pt=["src"],qt={key:1},Gt={key:0,class:"absolute right-0 mt-2 w-56 sm:w-48 bg-gatales-sidebar border border-gatales-border rounded-lg shadow-lg py-1 z-50"},Dt={class:"px-4 py-3 border-b border-gatales-border"},Ft={class:"text-sm font-medium text-gatales-text truncate"},Zt={class:"text-xs text-gatales-text-secondary truncate"},Kt={key:0,class:"w-5 h-5 text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ot={key:1,class:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Qt={key:0,class:"h-full flex flex-col"},Jt={class:"max-w-3xl mx-auto w-full py-4 px-3 sm:px-4 space-y-6"},Wt={class:"flex items-start gap-3"},Xt={class:"flex-1 space-y-2"},Yt={class:"space-y-2"},es={key:1,class:"h-full flex items-center justify-center px-4"},ts={class:"text-center max-w-sm sm:max-w-md"},ss={class:"text-lg sm:text-xl font-semibold text-gatales-text mb-2"},as={class:"text-sm sm:text-base text-gatales-text-secondary"},os={key:2,class:"max-w-3xl mx-auto py-2 sm:py-4"},ns={key:0,class:"px-3 sm:px-4 py-4 sm:py-6 message-assistant"},ls={key:0,class:"fixed inset-y-0 right-0 z-50 w-full max-w-sm bg-gatales-sidebar border-l border-gatales-border shadow-xl flex flex-col"},rs={class:"flex items-center justify-between p-4 border-b border-gatales-border"},is={class:"flex-1 overflow-y-auto p-4 space-y-3"},ds=["onClick","disabled"],cs={class:"flex items-start gap-3"},us={class:"flex-1 min-w-0"},vs={class:"flex items-center gap-2 flex-wrap"},gs={class:"font-semibold text-gatales-text"},ps={key:0,class:"text-xs px-2 py-0.5 rounded-full bg-gatales-accent text-white"},ms={key:1,class:"text-xs px-2 py-0.5 rounded-full bg-blue-500/20 text-blue-400"},xs={key:0,class:"text-sm text-gatales-text-secondary mt-1 line-clamp-2"},fs={key:0,class:"shrink-0"},hs={key:0,class:"text-center py-6"},bs={class:"w-full max-w-md bg-gatales-sidebar border border-gatales-border rounded-xl shadow-xl"},ys={class:"flex items-center justify-between p-4 border-b border-gatales-border"},ws={key:0,class:"bg-green-500/10 border border-green-500/50 text-green-400 px-4 py-3 rounded-lg text-sm"},ks={key:1,class:"bg-red-500/10 border border-red-500/50 text-red-400 px-4 py-3 rounded-lg text-sm"},Cs={class:"flex gap-3 pt-2"},_s=["disabled"],Ms={key:0,class:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},$s={class:"w-full max-w-md bg-gatales-sidebar border border-gatales-border rounded-xl shadow-xl"},Ss={class:"flex items-center justify-between p-4 border-b border-gatales-border"},js={class:"p-6 space-y-6"},Bs={key:0,class:"bg-red-500/10 border border-red-500/50 text-red-400 px-4 py-3 rounded-lg text-sm"},Ls={class:"flex flex-col items-center"},zs={class:"w-28 h-28 rounded-full bg-gatales-input flex items-center justify-center overflow-hidden border-4 border-gatales-border shadow-lg"},As=["src"],Ts={key:1,class:"text-4xl font-bold text-gatales-accent"},Es={class:"mt-5 cursor-pointer inline-flex items-center gap-2 px-4 py-2.5 bg-gatales-input hover:bg-gatales-border border border-gatales-border rounded-lg transition-colors"},Rs={class:"flex gap-3 pt-2"},Hs=["disabled"],Is=["disabled"],Vs={key:0,class:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},Us={__name:"ChatView",setup(B){const w=Se(),i=_e(),a=Be(),d=ie(),g=Le(),x=h(null),m=h(!1),k=h(!1),$=h(!1),M=h(!1),f=h(!1),b=h({current_password:"",password:"",password_confirmation:""}),L=h(""),E=h(""),S=h(!1),R=h(null),H=h(null),y=h(""),r=h(!1),s=h(window.innerWidth>=768);let j=null;function V(){clearTimeout(j),j=setTimeout(()=>{s.value=window.innerWidth>=768,s.value&&($.value=!0)},150)}Me(()=>{window.removeEventListener("resize",V),clearTimeout(j),clearTimeout(te)});const C=_(()=>a.currentAssistant?.name||"El Cursales"),z=_(()=>a.currentAssistant?.welcome_message||"?Sobre que tema te gustaria crear un video hoy?"),K=_(()=>a.currentConversation?.title||"Nueva conversacion");$e(async()=>{window.addEventListener("resize",V,{passive:!0}),V();try{if(await i.fetchUser(!0),!i.isActive){w.push("/account-inactive");return}if(i.hasFreePlan){w.push("/free-plan");return}const[u]=await Promise.all([d.fetchConversations(),a.fetchAvailableAssistants()]);if(d.currentConversationId)await a.setCurrentConversation(d.currentConversationId);else if(d.hasConversations){const t=Object.values(d.groupedConversations)[0];if(t?.conversations?.length>0){const l=t.conversations[0];d.selectConversation(l.id),await a.setCurrentConversation(l.id)}}I()}catch(u){if(console.error("Error loading chat:",u),u.response?.status===403&&u.response?.data?.status==="inactive"){w.push("/account-inactive");return}if(u.response?.status===401){w.push("/login");return}}});async function ee(u){u!==a.currentConversationId&&(await O(),d.selectConversation(u),await a.setCurrentConversation(u),I(),s.value||($.value=!1))}async function O(){const u=a.currentConversationId;if(!u)return;if(!(a.messages.length>0))try{await d.deleteConversation(u)}catch(l){console.warn("Could not cleanup empty conversation:",l)}}function de(){s.value||($.value=!1)}async function ce(u){if(u===a.currentAssistant?.id){k.value=!1;return}if(confirm("?Cambiar de asistente? Se creara una nueva conversacion."))try{const l=await a.changeAssistant(u);k.value=!1,await d.fetchConversations(),l.conversation_id&&(d.selectConversation(l.conversation_id),a.currentConversationId=l.conversation_id)}catch(l){console.error("Error changing assistant:",l)}}async function ue(u){try{if(!a.currentConversationId){const l=await d.createConversation();a.currentConversationId=l.id,a.currentConversation=l}const t=await a.sendMessageStream(u);await J(),I(),t?.conversation?.title&&(a.currentConversation=t.conversation,d.updateConversationLocally(t.conversation.id,{title:t.conversation.title,last_message_at:new Date().toISOString()}))}catch{a.freePlanBlocked?w.push("/free-plan"):a.tokensExhausted&&w.push("/tokens-exhausted")}}let te=null;function le(){clearTimeout(te),te=setTimeout(()=>{I()},50)}oe(()=>[a.messages.length,a.isThinking,a.isStreaming],([u,t,l],[Q])=>{u!==Q?J(()=>I()):t?J(()=>I()):l&&le()}),oe(()=>a.streamingContent,()=>{a.isStreaming&&le()});function ve(){a.stopStreaming()}async function ge(){try{await a.retryLastMessage(),I()}catch(u){console.error("Error retrying message:",u)}}async function pe(){try{await a.regenerateResponse(),I()}catch(u){console.error("Error regenerating message:",u)}}async function me(u){try{const t=a.messages.findIndex(l=>l.id===u.id);t!==-1&&a.messages.splice(t,1),await a.sendMessageStream(u.content,a.currentConversationId),I()}catch(t){console.error("Error resending message:",t)}}async function xe(){confirm("?Estas seguro de que quieres limpiar el historial de esta conversacion? Esta accion no se puede deshacer.")&&(await a.clearHistory(),await d.fetchConversations())}async function fe(){await i.logout(),w.push("/login")}function I(){J(()=>{x.value&&(x.value.scrollTop=x.value.scrollHeight)})}function he(){m.value=!1,b.value={current_password:"",password:"",password_confirmation:""},L.value="",E.value="",M.value=!0}async function be(){if(L.value="",E.value="",b.value.password!==b.value.password_confirmation){L.value="Las contrase침as no coinciden";return}if(b.value.password.length<8){L.value="La contrase침a debe tener al menos 8 caracteres";return}S.value=!0;try{await ae.changePassword(b.value),E.value="Contrase침a actualizada correctamente",b.value={current_password:"",password:"",password_confirmation:""},setTimeout(()=>{M.value=!1},1500)}catch(u){L.value=u.response?.data?.message||"Error al cambiar la contrase침a"}finally{S.value=!1}}function ye(){m.value=!1,R.value=i.user?.avatar_url||null,H.value=null,y.value="",f.value=!0}function we(u){const t=u.target.files[0];if(t){if(t.size>2*1024*1024){y.value="La imagen debe ser menor a 2MB";return}if(!["image/jpeg","image/png","image/gif"].includes(t.type)){y.value="Solo se permiten im치genes JPG, PNG o GIF";return}H.value=t,R.value=URL.createObjectURL(t),y.value=""}}async function ke(){if(H.value){r.value=!0,y.value="";try{const u=await ae.uploadAvatar(H.value);i.user.avatar_url=u.data.avatar_url,localStorage.setItem("user",JSON.stringify(i.user)),f.value=!1}catch(u){y.value=u.response?.data?.message||"Error al subir la imagen"}finally{r.value=!1}}}async function Ce(){if(confirm("쮼liminar tu foto de perfil?")){r.value=!0;try{await ae.deleteAvatar(),i.user.avatar_url=null,localStorage.setItem("user",JSON.stringify(i.user)),R.value=null,f.value=!1}catch(u){y.value=u.response?.data?.message||"Error al eliminar la imagen"}finally{r.value=!1}}}return(u,t)=>(o(),n("div",zt,[T(q,{name:"slide-sidebar"},{default:P(()=>[G(T(Lt,{onSelect:ee,onClose:de,class:"fixed md:relative z-30 h-full"},null,512),[[je,$.value||s.value]])]),_:1}),T(q,{name:"fade"},{default:P(()=>[$.value&&!s.value?(o(),n("div",{key:0,onClick:t[0]||(t[0]=l=>$.value=!1),class:"fixed inset-0 z-20 bg-black/50 md:hidden"})):v("",!0)]),_:1}),e("div",At,[e("header",Tt,[e("div",Et,[e("button",{onClick:t[1]||(t[1]=l=>$.value=!$.value),class:"p-2 rounded-lg hover:bg-gatales-input transition-colors md:hidden"},[...t[17]||(t[17]=[e("svg",{class:"w-5 h-5 text-gatales-text",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})],-1)])]),t[20]||(t[20]=X('<div class="hidden sm:flex items-center gap-2" data-v-6417c8be><div class="w-8 h-8 bg-gatales-accent rounded-lg flex items-center justify-center" data-v-6417c8be><svg class="w-6 h-6 text-white" viewBox="0 0 100 100" fill="currentColor" data-v-6417c8be><path d="M50 15 L25 35 L25 60 Q25 80 50 85 Q75 80 75 60 L75 35 Z" data-v-6417c8be></path><path d="M25 35 L15 10 L35 30 Z" data-v-6417c8be></path><path d="M75 35 L85 10 L65 30 Z" data-v-6417c8be></path></svg></div><h1 class="text-lg sm:text-xl font-bold text-gatales-accent" data-v-6417c8be>El Cursales</h1></div>',1)),e("div",Rt,[e("span",Ht,p(K.value),1)]),c(a).availableAssistants.length>1?(o(),n("button",{key:0,onClick:t[2]||(t[2]=l=>k.value=!0),class:"flex items-center gap-1 px-2 py-1 rounded-lg bg-gatales-input hover:bg-gatales-border transition-colors text-xs sm:text-sm"},[t[18]||(t[18]=e("svg",{class:"w-4 h-4 text-gatales-accent",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})],-1)),e("span",It,p(C.value),1),t[19]||(t[19]=e("svg",{class:"w-3 h-3 text-gatales-text-secondary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))])):v("",!0)]),e("div",Vt,[T(ct,{balance:c(i).tokensBalance,monthly:c(i).tokensMonthly},null,8,["balance","monthly"]),e("div",Ut,[e("button",{onClick:t[3]||(t[3]=l=>m.value=!m.value),class:"flex items-center gap-1 sm:gap-2 p-1.5 sm:px-3 sm:py-2 rounded-lg hover:bg-gatales-input transition-colors"},[e("div",Nt,[c(i).user?.avatar_url?(o(),n("img",{key:0,src:c(i).user.avatar_url,class:"w-full h-full object-cover",alt:"Avatar"},null,8,Pt)):(o(),n("span",qt,p(c(i).user?.name?.charAt(0)?.toUpperCase()||"U"),1))]),t[21]||(t[21]=e("svg",{class:"w-4 h-4 text-gatales-text-secondary hidden sm:block",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))]),m.value?(o(),n("div",Gt,[e("div",Dt,[e("p",Ft,p(c(i).user?.name),1),e("p",Zt,p(c(i).user?.email),1)]),e("button",{onClick:t[4]||(t[4]=(...l)=>c(g).toggleTheme&&c(g).toggleTheme(...l)),class:"w-full flex items-center justify-between px-4 py-3 text-sm text-gatales-text hover:bg-gatales-input active:bg-gatales-border"},[e("span",null,"Tema "+p(c(g).theme==="dark"?"Oscuro":"Claro"),1),c(g).theme==="light"?(o(),n("svg",Kt,[...t[22]||(t[22]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"},null,-1)])])):(o(),n("svg",Ot,[...t[23]||(t[23]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"},null,-1)])]))]),e("button",{onClick:ye,class:"w-full flex items-center gap-3 px-4 py-3 text-sm text-gatales-text hover:bg-gatales-input active:bg-gatales-border"},[...t[24]||(t[24]=[e("svg",{class:"w-5 h-5 text-gatales-text-secondary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),U(" Cambiar foto ",-1)])]),e("button",{onClick:he,class:"w-full flex items-center gap-3 px-4 py-3 text-sm text-gatales-text hover:bg-gatales-input active:bg-gatales-border"},[...t[25]||(t[25]=[e("svg",{class:"w-5 h-5 text-gatales-text-secondary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})],-1),U(" Cambiar contrase침a ",-1)])]),e("button",{onClick:xe,class:"w-full text-left px-4 py-3 text-sm text-gatales-text hover:bg-gatales-input active:bg-gatales-border"}," Limpiar historial "),e("button",{onClick:fe,class:"w-full text-left px-4 py-3 text-sm text-red-400 hover:bg-gatales-input active:bg-gatales-border"}," Cerrar sesion ")])):v("",!0)])])]),m.value?(o(),n("div",{key:0,onClick:t[5]||(t[5]=l=>m.value=!1),class:"fixed inset-0 z-40"})):v("",!0),e("main",{ref_key:"messagesContainer",ref:x,class:"flex-1 overflow-y-auto overscroll-contain"},[c(a).isLoading?(o(),n("div",Qt,[e("div",Jt,[(o(),n(N,null,Z(3,l=>e("div",{key:l,class:"animate-pulse"},[e("div",Wt,[t[27]||(t[27]=e("div",{class:"w-8 h-8 rounded-full bg-gatales-input shrink-0"},null,-1)),e("div",Xt,[t[26]||(t[26]=e("div",{class:"h-3 w-16 bg-gatales-input rounded"},null,-1)),e("div",Yt,[e("div",{class:"h-4 bg-gatales-input rounded",style:Y({width:70+l*10+"%"})},null,4),e("div",{class:"h-4 bg-gatales-input rounded",style:Y({width:50+l*15+"%"})},null,4),l<3?(o(),n("div",{key:0,class:"h-4 bg-gatales-input rounded",style:Y({width:40+l*10+"%"})},null,4)):v("",!0)])])])])),64))]),t[28]||(t[28]=X('<div class="flex-1 flex items-center justify-center pb-20" data-v-6417c8be><div class="text-center" data-v-6417c8be><svg class="animate-spin h-8 w-8 text-gatales-accent mx-auto mb-3" fill="none" viewBox="0 0 24 24" data-v-6417c8be><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-6417c8be></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z" data-v-6417c8be></path></svg><p class="text-sm text-gatales-text-secondary" data-v-6417c8be>Cargando conversacion...</p></div></div>',1))])):c(a).hasMessages?(o(),n("div",os,[(o(!0),n(N,null,Z(c(a).messages,(l,Q)=>(o(),W(Oe,{key:l.id,message:l,"user-avatar":c(i).user?.avatar_url,"user-name":c(i).user?.name||"Usuario","is-last-message":Q===c(a).messages.length-1,"is-generating":c(a).isSending||c(a).isStreaming||c(a).isThinking,onRetry:ge,onRegenerate:pe,onResend:Ns=>me(l)},null,8,["message","user-avatar","user-name","is-last-message","is-generating","onResend"]))),128)),c(a).isSending&&!c(a).isStreaming&&!c(a).isThinking?(o(),n("div",ns,[...t[30]||(t[30]=[X('<div class="flex items-start gap-3 sm:gap-4 max-w-3xl mx-auto" data-v-6417c8be><div class="w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-gatales-accent flex items-center justify-center flex-shrink-0" data-v-6417c8be><svg class="w-5 h-5 sm:w-6 sm:h-6 text-white" viewBox="0 0 100 100" fill="currentColor" data-v-6417c8be><path d="M50 15 L25 35 L25 60 Q25 80 50 85 Q75 80 75 60 L75 35 Z" data-v-6417c8be></path><path d="M25 35 L15 10 L35 30 Z" data-v-6417c8be></path><path d="M75 35 L85 10 L65 30 Z" data-v-6417c8be></path></svg></div><div class="typing-indicator" data-v-6417c8be><span data-v-6417c8be></span><span data-v-6417c8be></span><span data-v-6417c8be></span></div></div>',1)])])):v("",!0)])):(o(),n("div",es,[e("div",ts,[t[29]||(t[29]=e("div",{class:"w-14 h-14 sm:w-16 sm:h-16 mx-auto mb-4 rounded-full bg-gatales-accent/20 flex items-center justify-center"},[e("svg",{class:"w-7 h-7 sm:w-8 sm:h-8 text-gatales-accent",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})])],-1)),e("h2",ss,p(C.value),1),e("p",as,p(z.value),1)])]))],512),T(Ye,{onSend:ue,onStop:ve,disabled:c(a).isThinking,isStreaming:c(a).isStreaming||c(a).isThinking},null,8,["disabled","isStreaming"])]),(o(),W(se,{to:"body"},[T(q,{name:"fade"},{default:P(()=>[k.value?(o(),n("div",{key:0,class:"fixed inset-0 z-50 bg-black/60",onClick:t[6]||(t[6]=l=>k.value=!1)})):v("",!0)]),_:1}),T(q,{name:"slide"},{default:P(()=>[k.value?(o(),n("div",ls,[e("div",rs,[t[32]||(t[32]=e("div",null,[e("h3",{class:"text-lg font-semibold text-gatales-text"},"Elegir Asistente"),e("p",{class:"text-xs text-gatales-text-secondary mt-0.5"},"Selecciona tu GPT preferido")],-1)),e("button",{onClick:t[7]||(t[7]=l=>k.value=!1),class:"p-2 rounded-lg hover:bg-gatales-input transition-colors"},[...t[31]||(t[31]=[e("svg",{class:"w-5 h-5 text-gatales-text-secondary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",is,[(o(!0),n(N,null,Z(c(a).availableAssistants,l=>(o(),n("button",{key:l.id,onClick:Q=>ce(l.id),disabled:c(a).isChangingAssistant,class:A(["w-full text-left p-4 rounded-xl border-2 transition-all duration-200",l.id===c(a).currentAssistant?.id?"border-gatales-accent bg-gatales-accent/10 shadow-lg shadow-gatales-accent/20":"border-gatales-border hover:border-gatales-accent/50 hover:bg-gatales-input"])},[e("div",cs,[t[34]||(t[34]=e("div",{class:"w-12 h-12 rounded-xl bg-gatales-accent/20 flex items-center justify-center shrink-0"},[e("svg",{class:"w-6 h-6 text-gatales-accent",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})])],-1)),e("div",us,[e("div",vs,[e("p",gs,p(l.name),1),l.id===c(a).currentAssistant?.id?(o(),n("span",ps," Activo ")):v("",!0),l.is_default?(o(),n("span",ms," Por defecto ")):v("",!0)]),l.description?(o(),n("p",xs,p(l.description),1)):v("",!0)]),l.id===c(a).currentAssistant?.id?(o(),n("div",fs,[...t[33]||(t[33]=[e("svg",{class:"w-6 h-6 text-gatales-accent",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1)])])):v("",!0)])],10,ds))),128)),c(a).isChangingAssistant?(o(),n("div",hs,[...t[35]||(t[35]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-2 border-gatales-accent border-t-transparent"},null,-1),e("p",{class:"text-sm text-gatales-text-secondary mt-3"},"Cambiando asistente...",-1)])])):v("",!0)]),t[36]||(t[36]=e("div",{class:"p-4 border-t border-gatales-border bg-gatales-bg/50"},[e("p",{class:"text-xs text-gatales-text-secondary text-center"}," Al cambiar de asistente, se creara una nueva conversacion. ")],-1))])):v("",!0)]),_:1})])),(o(),W(se,{to:"body"},[T(q,{name:"fade"},{default:P(()=>[M.value?(o(),n("div",{key:0,class:"fixed inset-0 z-50 bg-black/60 flex items-center justify-center p-4",onClick:t[13]||(t[13]=D(l=>M.value=!1,["self"]))},[e("div",bs,[e("div",ys,[t[38]||(t[38]=e("h3",{class:"text-lg font-semibold text-gatales-text"},"Cambiar contrase침a",-1)),e("button",{onClick:t[8]||(t[8]=l=>M.value=!1),class:"p-2 rounded-lg hover:bg-gatales-input transition-colors"},[...t[37]||(t[37]=[e("svg",{class:"w-5 h-5 text-gatales-text-secondary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:D(be,["prevent"]),class:"p-4 space-y-4"},[E.value?(o(),n("div",ws,p(E.value),1)):v("",!0),L.value?(o(),n("div",ks,p(L.value),1)):v("",!0),e("div",null,[t[39]||(t[39]=e("label",{class:"block text-sm font-medium text-gatales-text-secondary mb-1"},"Contrase침a actual",-1)),G(e("input",{"onUpdate:modelValue":t[9]||(t[9]=l=>b.value.current_password=l),type:"password",required:"",class:"input-field",placeholder:"Tu contrase침a actual"},null,512),[[F,b.value.current_password]])]),e("div",null,[t[40]||(t[40]=e("label",{class:"block text-sm font-medium text-gatales-text-secondary mb-1"},"Nueva contrase침a",-1)),G(e("input",{"onUpdate:modelValue":t[10]||(t[10]=l=>b.value.password=l),type:"password",required:"",class:"input-field",placeholder:"M칤nimo 8 caracteres"},null,512),[[F,b.value.password]])]),e("div",null,[t[41]||(t[41]=e("label",{class:"block text-sm font-medium text-gatales-text-secondary mb-1"},"Confirmar nueva contrase침a",-1)),G(e("input",{"onUpdate:modelValue":t[11]||(t[11]=l=>b.value.password_confirmation=l),type:"password",required:"",class:"input-field",placeholder:"Repite la nueva contrase침a"},null,512),[[F,b.value.password_confirmation]])]),e("div",Cs,[e("button",{type:"button",onClick:t[12]||(t[12]=l=>M.value=!1),class:"flex-1 btn-secondary"}," Cancelar "),e("button",{type:"submit",disabled:S.value,class:"flex-1 btn-primary"},[S.value?(o(),n("svg",Ms,[...t[42]||(t[42]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):v("",!0),U(" "+p(S.value?"Guardando...":"Guardar"),1)],8,_s)])],32)])])):v("",!0)]),_:1})])),(o(),W(se,{to:"body"},[T(q,{name:"fade"},{default:P(()=>[f.value?(o(),n("div",{key:0,class:"fixed inset-0 z-50 bg-black/60 flex items-center justify-center p-4",onClick:t[16]||(t[16]=D(l=>f.value=!1,["self"]))},[e("div",$s,[e("div",Ss,[t[44]||(t[44]=e("h3",{class:"text-lg font-semibold text-gatales-text"},"Cambiar foto de perfil",-1)),e("button",{onClick:t[14]||(t[14]=l=>f.value=!1),class:"p-2 rounded-lg hover:bg-gatales-input transition-colors"},[...t[43]||(t[43]=[e("svg",{class:"w-5 h-5 text-gatales-text-secondary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",js,[y.value?(o(),n("div",Bs,p(y.value),1)):v("",!0),e("div",Ls,[e("div",zs,[R.value?(o(),n("img",{key:0,src:R.value,class:"w-full h-full object-cover",alt:"Avatar"},null,8,As)):(o(),n("span",Ts,p(c(i).user?.name?.charAt(0)?.toUpperCase()||"U"),1))]),e("label",Es,[t[45]||(t[45]=e("svg",{class:"w-5 h-5 text-gatales-text-secondary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),t[46]||(t[46]=e("span",{class:"text-sm font-medium text-gatales-text"},"Seleccionar imagen",-1)),e("input",{type:"file",accept:"image/jpeg,image/png,image/gif",class:"hidden",onChange:we},null,32)]),t[47]||(t[47]=e("p",{class:"text-xs text-gatales-text-secondary mt-2"},"JPG, PNG o GIF. M치ximo 2MB.",-1))]),e("div",Rs,[c(i).user?.avatar_url?(o(),n("button",{key:0,type:"button",onClick:Ce,disabled:r.value,class:"px-4 py-2.5 text-sm font-medium text-red-400 border border-red-500/30 hover:bg-red-500/10 rounded-lg transition-colors"}," Eliminar ",8,Hs)):v("",!0),e("button",{type:"button",onClick:t[15]||(t[15]=l=>f.value=!1),class:"flex-1 px-4 py-2.5 text-sm font-medium text-gatales-text bg-gatales-input hover:bg-gatales-border border border-gatales-border rounded-lg transition-colors"}," Cancelar "),e("button",{onClick:ke,disabled:!H.value||r.value,class:"flex-1 px-4 py-2.5 text-sm font-medium text-white bg-gatales-accent hover:bg-gatales-accent-hover disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors flex items-center justify-center gap-2"},[r.value?(o(),n("svg",Vs,[...t[48]||(t[48]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):v("",!0),U(" "+p(r.value?"Subiendo...":"Guardar"),1)],8,Is)])])])])):v("",!0)]),_:1})]))]))}},Fs=ne(Us,[["__scopeId","data-v-6417c8be"]]);export{Fs as default};
